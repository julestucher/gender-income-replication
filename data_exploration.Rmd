---
title: "Data Exploration"
author: "Jules Tucher"
date: "2025-10-21"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(haven)
data_dir <- "/Users/juliatucher/Documents/DACSS/POLISCI 788/Final Project/Gender income/Replication Files Plos/"
data_raw <- read_dta(file.path(data_dir, "tables.dta")) 
```

```{r power-analysis}
#install.packages("pwrss")
library(pwrss)

sds <- data_std_outcomes %>%
  select(all_of(c(outcomes, "recode_diff_wage_OR", "recode_diff_wage_OR_int", "recode_diff_wage"))) %>%
  filter(recode_diff_wage_OR < 19, recode_diff_wage_OR > -19) %>%
  summarize_all(~mean(.x, na.rm=T))

for(var in outcomes) {
  print(var)
  sd.out <- sds %>% select(matches(var)) %>% as.numeric()
  sd.pred <- sds %>% select(recode_diff_wage_OR) %>% as.numeric()
  beta = ifelse(str_detect(var, "std"), 0.005, 0.05)
  power.t.regression(beta = beta, # expected coefficient
                     sd.predictor = sd.pred,
                     sd.outcome = sd.out, 
                     k.total = 7, # total number of predictors
                     r.squared = (beta * sd.pred / sd.out)^2,
                     power = 0.95, # no default, probability of correctly rejecting the null
                     alpha = 0.05, # probability of type 1 error
                     alternative = "two.sided")
  }

  


```

```{r clean-variables-ind-fe}

# foreach outcome in $outcomes {
# 
# areg  `outcome', abs(pid)
# 
# predict `outcome'_res, res
# 
# 
# }
# 
# 
# global outcomes_res  overalllifesat_res worksat_res m11125_res std_mcs_res std_pcs_res 
# 
# 
# foreach outcome in $outcomes_female {
# 
# areg  `outcome', abs(pid)
# 
# predict `outcome'_res, res
# 
# 
# }
# 
# rename overalllifesat_female_res overalllifesat_res_female
# *rename familylifesat_female_res familylifesat_res_female
# *rename houseworksat_female_res houseworksat_res_female
# rename worksat_female_res worksat_res_female
# 
# rename m11125_female_res m11125_res_female
# rename std_mcs_female_res std_mcs_res_female
# rename std_pcs_female_res std_pcs_res_female
# 
# 
# 
# global outcomes_res_female  overalllifesat_res_female worksat_res_female m11125_res_female std_mcs_res_female std_pcs_res_female 
# 
# global threshold 0.00001
# 
# g dummy=(diff_wage_OR>0) if !missing(diff_wage_OR)
# g running_int=recode_diff_wage_OR*west
# global running_int running_int 

```
## Data Exploration

### Wife-Husband Wage Difference

## Table 1

## Table 2
